# NagaAgent 常见问题 (FAQ)

---

## 📋 目录

- [安装相关](#安装相关)
- [配置相关](#配置相关)
- [功能相关](#功能相关)
- [连接相关](#连接相关)
- [性能相关](#性能相关)
- [其他问题](#其他问题)

---

## 安装相关

### Q: 支持哪些 Python 版本？

A: NagaAgent 需要使用 **Python 3.11**。

### Q: 如何安装依赖？

A: 运行安装脚本：

```bash
# Windows
setup.bat

# Linux/macOS
./setup.sh
```

或手动安装：

```bash
python -m venv .venv
source .venv/bin/activate  # Windows: .\.venv\Scripts\activate
pip install -r requirements.txt
```

### Q: 安装依赖失败怎么办？

A: 尝试以下方法：

1. 升级 pip
   ```bash
   python -m pip install --upgrade pip
   ```

2. 使用国内镜像源
   ```bash
   pip install -r requirements.txt -i https://pypi.tuna.tsinghua.edu.cn/simple
   ```

3. 使用 uv 安装
   ```bash
   pip install uv
   uv sync
   ```

---

## 配置相关

### Q: 如何配置 API？

A: 编辑 `config.json` 文件：

```json
{
  "api": {
    "api_key": "your_api_key",
    "base_url": "https://api.openai.com/v1",
    "model": "gpt-4"
  }
}
```

### Q: 支持哪些 LLM 提供商？

A: 支持 OpenAI、DeepSeek、Claude、Azure OpenAI 等兼容 OpenAI API 格式的提供商。

| 提供商 | base_url |
|--------|----------|
| OpenAI | `https://api.openai.com/v1` |
| DeepSeek | `https://api.deepseek.com/v1` |
| Claude | `https://api.anthropic.com/v1` |
| Azure | `https://你的资源.openai.azure.com/` |

### Q: 如何配置 QQ 机器人？

A: 详见 [QQ 机器人配置](./配置指南/QQ机器人配置.md)。

### Q: 如何配置微信机器人？

A: 微信机器人通过扫码登录，只需在 `config.json` 中启用：

```json
{
  "qq_wechat": {
    "wechat": {
      "enabled": true,
      "auto_login": true
    }
  }
}
```

### Q: 如何配置语音功能？

A: 详见 [语音功能配置](./配置指南/语音功能配置.md)。

### Q: 如何启用记忆系统？

A: 配置 Neo4j：

```json
{
  "grag": {
    "enabled": true,
    "neo4j_uri": "neo4j://127.0.0.1:7687",
    "neo4j_user": "neo4j",
    "neo4j_password": "your_password"
  }
}
```

---

## 功能相关

### Q: 什么是初意识？

A: 初意识是弥娅的原生意识（灵魂），让她拥有独立思考能力。弥娅基于记忆和人生书思考，将大模型作为工具调用，而不是直接使用大模型的回复。详见 [初意识系统文档](初意识系统.md)。

### Q: 如何切换意识模式？

A: 运行脚本：
```bash
python scripts/switch_consciousness.py
```

### Q: 如何切换聊天模式？

A: 在 QQ 中使用命令：

- `/text` 或 `/文字` - 文本模式
- `/voice` 或 `/语音` - 语音模式
- `/both` 或 `/图文` - 图文模式

### Q: 如何查看可用工具？

A: 使用命令 `/tools` 或 `/工具` 查看所有可用工具。

### Q: 如何使用 AI 绘图？

A: 直接对弥娅说：
- "画一只可爱的猫咪"
- "AI绘图：日落时的海滩"

### Q: 群聊中 AI 不回复怎么办？

A: 检查配置：

1. 确认 `enable_group_reply` 为 `true`
2. 检查 `group_reply_mode` 设置
3. 如果是 `at_only` 模式，需要 @ 机器人
4. 检查群是否在黑名单中

---

## 连接相关

### Q: QQ 机器人连接失败怎么办？

A: 检查以下项目：

1. NapCat 是否正在运行
   ```bash
   curl http://127.0.0.1:3000
   ```

2. `config.json` 中的配置是否正确
   - `http_url` 是否为 `http://127.0.0.1:3000`
   - `bot_qq` 是否正确
   - `http_token` 和 `ws_token` 是否与 NapCat 配置一致

3. 尝试清空 `http_token` 和 `ws_token`

### Q: GPT-SoVITS 连接失败怎么办？

A: 1. 启动 GPT-SoVITS 服务
   ```bash
   cd GPT-SoVITS目录
   python api_v2.py
   ```

2. 确认服务地址
   ```bash
   curl http://127.0.0.1:9880
   ```

3. 检查 `config.json` 中的 `gpt_sovits_url` 配置

### Q: 移动端无法访问怎么办？

A: 1. 确认 `api_server.host` 为 `"0.0.0.0"`
2. 配置防火墙允许端口 8000
3. 确认手机和电脑在同一 Wi-Fi 网络
4. 检查电脑 IP 地址是否正确

### Q: Neo4j 连接失败怎么办？

A: 1. 确认 Neo4j 服务正在运行
2. 检查连接参数是否正确
3. 如果一直失败，可以暂时禁用 GRAG 功能

---

## 性能相关

### Q: AI 回复速度慢怎么办？

A: 尝试以下方法：

1. 检查网络连接是否稳定
2. 使用更快的 LLM（如 DeepSeek）
3. 减少 `max_tokens` 参数
4. 降低 `temperature` 参数

### Q: 程序占用内存高怎么办？

A: 1. 禁用不必要的功能（如 Neo4j、Live2D）
2. 减少对话历史长度
3. 定期清理缓存

### Q: 端口被占用怎么办？

A: 端口说明：
- 8000 - API 服务器
- 8001 - Agent 服务器
- 8003 - MCP 服务器
- 5048 - TTS 服务器

解决方法：
1. 查找占用端口的进程
   ```bash
   # Windows
   netstat -ano | findstr :8000

   # Linux/Mac
   lsof -i :8000
   ```

2. 结束占用进程或修改 `config.json` 中的端口号

---

## 其他问题

### Q: 如何查看日志？

A: 日志存储在 `logs/` 目录下：

```bash
# Windows
type logs\nagaagent.log

# Linux/Mac
tail -f logs/nagaagent.log
```

### Q: 如何更新 NagaAgent？

A: 运行更新脚本：

```bash
# Windows
update.bat

# Linux/macOS
./update.sh
```

### Q: 如何配置 BettaFish 舆情分析？

A: 详见 [BettaFish 配置](./配置指南/BettaFish配置.md)。

### Q: 如何切换数据库模式？

A: 运行脚本：

```bash
python scripts/switch_database.py
```

### Q: 有哪些快捷命令？

A:

| 命令 | 功能 |
|------|------|
| `/help` 或 `/帮助` | 显示帮助信息 |
| `/text` 或 `/文字` | 切换到文本模式 |
| `/voice` 或 `/语音` | 切换到语音模式 |
| `/both` 或 `/图文` | 切换到图文模式 |
| `/mode` 或 `/模式` | 查看当前配置 |
| `/tools` 或 `/工具` | 查看所有可用工具 |

### Q: 如何禁用某个功能？

A: 在 `config.json` 中将对应的 `enabled` 设置为 `false`。

### Q: 如何重置配置？

A: 删除 `config.json`，复制 `config.json.example` 并重命名：

```bash
cp config.json.example config.json
```

---

## 获取更多帮助

如果以上 FAQ 没有解答你的问题：

1. 查看 [故障排查指南](./故障排查.md)
2. 查看 [功能使用指南](./功能指南.md)
3. 查看 [配置指南](./配置指南/配置总览.md)
4. 在 GitHub 提交 Issue

---

## 📚 相关文档

- [快速开始](./快速开始.md)
- [功能使用指南](./功能指南.md)
- [配置指南](./配置指南/配置总览.md)
- [故障排查](./故障排查.md)
