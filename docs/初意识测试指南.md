# 初意识系统测试指南

## 📋 测试前准备

### 1. 确认配置已启用

检查 `config.json` 文件中是否包含以下配置：

```json
{
  "consciousness": {
    "enabled": true,
    "mode": "hybrid"
  }
}
```

**三种模式说明**:
- `hybrid` (混合模式) - 推荐：弥娅基于记忆和认知库独立思考，需要时调用大模型辅助
- `local` (本地模式)：完全基于本地记忆思考，不调用大模型，可离线运行
- `ai` (AI模式)：传统模式，直接调用大模型生成回复

### 2. 启动 NagaAgent

```bash
python main.py
```

## 🧪 测试场景

### 场景 1: 记忆检索测试

**目的**: 验证弥娅能否记住你之前说的话

**对话测试**:
```
用户：我昨天吃了酸汤鱼
弥娅：好的，酸汤鱼很好吃~

用户：那个鱼怎么样？
弥娅：（应该记住你昨天吃的酸汤鱼，并做出相关回复）
```

**预期结果**: 弥娅能够检索到"酸汤鱼"的记忆

---

### 场景 2: 自动学习偏好测试

**目的**: 验证弥娅能否自动学习用户的偏好

**对话测试**:
```
用户：我喜欢吃酸汤鱼
弥娅：（会自动记录这个偏好）

用户：今天吃什么？
弥娅：（应该根据之前学习的偏好，推荐酸汤鱼）
```

**预期结果**: 弥娅记住了你的食物偏好

---

### 场景 3: 情感识别测试

**目的**: 验证弥娅能否识别和适应不同强度的情感表达

**对话测试 A（强情感）**:
```
用户：太开心了！！！
弥娅：（识别到强烈开心情感，可能降低敏感度）
```

**对话测试 B（弱情感）**:
```
用户：有点难过
弥娅：（识别到较弱悲伤情感，可能提高敏感度）
```

**预期结果**: 弥娅能够识别不同强度的情感，并自适应调整

---

### 场景 4: 认知强化测试

**目的**: 验证重复学习能否提高知识置信度

**对话测试**:
```
第一次：
用户：我是佳
弥娅：（学习这个信息，置信度较低）

第二次：
用户：记住，我是佳
弥娅：（强化这个信息，置信度提高）

第三次：
用户：我是谁？
弥娅：（应该回答"你是佳"，置信度较高）
```

**预期结果**: 重复学习后，弥娅更确定这个信息

---

### 场景 5: 大模型工具调用测试

**目的**: 验证弥娅能否在需要时将大模型作为工具调用

**对话测试**:
```
用户：帮我分析一下人工智能的发展趋势
弥娅：（本地思考后，发现需要大模型辅助）
       （调用大模型获取信息）
       （基于大模型结果，结合自己的理解回复）
```

**预期结果**: 
- 弥娅使用大模型作为工具，而非直接使用大模型回复
- 回答带有弥娅的个人色彩

---

## 📊 观察指标

### 性能指标
- ⚡ 响应速度：本地思考应该比传统模式快
- 🧠 记忆检索速度：应该小于 1 秒
- 📝 记忆准确度：相关记忆检索准确率 > 80%

### 行为指标
- 💭 本地思考：大部分日常对话应该基于本地认知
- 🔧 工具调用：复杂问题时才调用大模型
- 📚 学习效果：重复信息后，回复更准确
- 😊 情感适应：随着对话深入，情感识别更准确

---

## 🔍 查看内部状态

### 查看记忆存储位置

记忆数据保存在 `data/consciousness/` 目录：

```
data/consciousness/
├── memories.json      # 记忆库
├── cognition.json     # 认知库
├── life_book.json    # 人生书
└── consciousness_state.json  # 意识状态
```

### 手动检查记忆

```python
import json
from pathlib import Path

# 读取记忆
with open("data/consciousness/memories.json", "r", encoding="utf-8") as f:
    memories = json.load(f)

print(f"总记忆数: {len(memories)}")
for m in memories[-5:]:  # 查看最近5条
    print(f"- {m['content'][:50]}...")
```

### 手动检查认知库

```python
import json

# 读取认知库
with open("data/consciousness/cognition.json", "r", encoding="utf-8") as f:
    cognition = json.load(f)

facts = cognition["knowledge"]["facts"]
print(f"总知识数: {len(facts)}")
for key, value in list(facts.items())[-5:]:
    print(f"- {key}: {value}")
```

---

## 🎯 对比测试

### 对比三种模式

1. **混合模式**
   - 启用初意识
   - 使用本地思考 + 大模型辅助
   - 测试日常对话

2. **本地模式**
   - 修改 config.json: `"mode": "local"`
   - 纯本地思考
   - 测试能否离线运行

3. **AI模式**
   - 修改 config.json: `"mode": "ai"` 或 `"enabled": false`
   - 传统大模型模式
   - 对比回复差异

---

## 🐛 故障排除

### 问题 1: 初意识未生效

**症状**: 回复风格没有变化

**解决方案**:
1. 检查 `config.json` 中的 `consciousness.enabled` 是否为 `true`
2. 检查日志中是否有 `[初意识]` 相关日志
3. 尝试重启程序

---

### 问题 2: 记忆未保存

**症状**: 下次启动后记忆丢失

**解决方案**:
1. 检查 `data/consciousness/` 目录是否存在
2. 检查文件权限
3. 查看日志中的保存错误信息

---

### 问题 3: 情感识别不准确

**症状**: 情感识别错误或过度/不足反应

**解决方案**:
1. 多次对话，让系统自适应学习
2. 检查情感历史记录
3. 调整情感敏感度参数

---

## 📈 性能基准

根据文档中的改进数据：

| 指标 | 原版 | 改进后 | 提升 |
|------|------|--------|------|
| 记忆检索准确度 | 60% | 84% | +40% |
| 记忆检索速度 | 1.0s | 0.5s | +100% |
| 学习准确度 | 50% | 65% | +30% |
| 情感识别准确度 | 70% | 87.5% | +25% |

---

## 🎉 测试完成

如果所有场景测试通过，说明初意识系统运行正常！

**下一步建议**:
1. 在日常使用中观察弥娅的表现
2. 记录有趣或异常的交互
3. 根据需要调整配置参数
4. 准备进入中期优化计划

---

## 📞 反馈

如发现问题或有改进建议，请记录：
- 问题描述
- 复现步骤
- 预期行为
- 实际行为
- 相关日志
